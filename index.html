<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø­ØµØµ Ø§Ù„Ø­Ø¶ÙˆØ±ÙŠØ© - Ø£ÙƒØ§Ø¯ÙŠÙ…ÙŠØ© Ù…Ù„Ù‡Ù… Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ©</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700;800&family=Tajawal:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        :root {
            --primary: #6a2df3;
            --primary-dark: #4b1fad;
            --primary-light: #8a5cf5;
            --secondary: #ff8a3c;
            --secondary-light: #ffb37c;
            --accent: #22b8aa;
            --accent-light: #5ce0d2;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            
            --purple-gradient: linear-gradient(135deg, #6a2df3, #8a5cf5);
            --orange-gradient: linear-gradient(135deg, #ff8a3c, #ffb37c);
            --teal-gradient: linear-gradient(135deg, #22b8aa, #5ce0d2);
            
            --bg-light: #f7f4ff;
            --bg-white: #ffffff;
            --text-dark: #15162b;
            --text-light: #5d6680;
            
            --radius-lg: 20px;
            --radius-md: 12px;
            --radius-sm: 8px;
            
            --shadow-soft: 0 10px 25px rgba(106, 45, 243, 0.1);
            --shadow-medium: 0 15px 35px rgba(106, 45, 243, 0.15);
            --shadow-strong: 0 20px 50px rgba(106, 45, 243, 0.2);
            
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Cairo', sans-serif;
            background: linear-gradient(135deg, #f7f4ff, #ffffff);
            color: var(--text-dark);
            line-height: 1.6;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Ø§Ù„Ù‡ÙŠØ¯Ø± */
        .header {
            text-align: center;
            margin-bottom: 40px;
            position: relative;
        }

        .header::after {
            content: '';
            position: absolute;
            bottom: -10px;
            right: 50%;
            transform: translateX(50%);
            width: 110px;
            height: 4px;
            background: var(--purple-gradient);
            border-radius: 2px;
        }

        .logo {
            display: inline-flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
            text-decoration: none;
        }

        .logo-img {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: white;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: var(--shadow-soft);
            padding: 5px;
            border: 3px solid var(--primary-light);
        }

        .logo-img img {
            width: 70px;
            height: 70px;
            border-radius: 50%;
            object-fit: contain;
        }

        .logo-text {
            text-align: right;
        }

        .logo-text h1 {
            font-size: 2rem;
            color: var(--primary-dark);
            margin-bottom: 5px;
            font-weight: 800;
            background: var(--purple-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .logo-text p {
            font-size: 1rem;
            color: var(--text-light);
            font-weight: 600;
        }

        .week-badge {
            display: inline-block;
            background: var(--orange-gradient);
            color: white;
            padding: 8px 20px;
            border-radius: 50px;
            font-weight: 700;
            margin-top: 10px;
            box-shadow: 0 4px 15px rgba(255, 138, 60, 0.3);
        }

        /* Ø´Ø§Ø±Ø© Ø§Ù„ØªÙˆØ§Ø±ÙŠØ® */
        .dates-badge {
            display: inline-block;
            margin-top: 10px;
            background: rgba(106, 45, 243, 0.08);
            color: var(--primary-dark);
            padding: 6px 16px;
            border-radius: 999px;
            font-size: 0.9rem;
            font-weight: 600;
        }

        /* Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª */
        .registration-card {
            background: var(--bg-white);
            border-radius: var(--radius-lg);
            padding: 40px;
            box-shadow: var(--shadow-medium);
            margin-bottom: 30px;
            border: 1px solid rgba(106, 45, 243, 0.1);
        }

        .progress-steps {
            display: flex;
            justify-content: space-between;
            margin-bottom: 40px;
            position: relative;
            counter-reset: step;
        }

        .progress-steps::before {
            content: '';
            position: absolute;
            top: 15px;
            right: 0;
            left: 0;
            height: 3px;
            background: #e5e7eb;
            z-index: 1;
        }

        .progress-bar {
            position: absolute;
            top: 15px;
            right: 0;
            height: 3px;
            background: var(--primary);
            z-index: 2;
            transition: var(--transition);
        }

        .step {
            position: relative;
            z-index: 3;
            text-align: center;
            width: 100px;
        }

        .step-icon {
            width: 36px;
            height: 36px;
            background: #e5e7eb;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 10px;
            color: var(--text-light);
            font-weight: 700;
            transition: var(--transition);
        }

        .step.active .step-icon {
            background: var(--primary);
            color: white;
            box-shadow: 0 4px 15px rgba(106, 45, 243, 0.3);
        }

        .step.completed .step-icon {
            background: var(--success);
            color: white;
        }

        .step-label {
            font-size: 0.85rem;
            color: var(--text-light);
            font-weight: 600;
        }

        .step.active .step-label {
            color: var(--primary);
        }

        /* Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ */
        .form-step {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .form-step.active {
            display: block;
        }

        .form-header {
            margin-bottom: 30px;
        }

        .form-header h2 {
            color: var(--primary-dark);
            margin-bottom: 10px;
            font-size: 1.6rem;
        }

        .form-header p {
            color: var(--text-light);
            font-size: 1rem;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            color: var(--text-dark);
            font-weight: 600;
            font-size: 0.95rem;
        }

        .required::after {
            content: ' *';
            color: var(--danger);
        }

        input, select, textarea {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #e5e7eb;
            border-radius: var(--radius-md);
            font-family: 'Cairo', sans-serif;
            font-size: 1rem;
            transition: var(--transition);
            background: var(--bg-white);
        }

        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(106, 45, 243, 0.1);
        }

        input.error, select.error, textarea.error {
            border-color: var(--danger);
            background: rgba(239, 68, 68, 0.02);
        }

        .error-message {
            color: var(--danger);
            font-size: 0.85rem;
            margin-top: 5px;
            display: none;
        }

        .form-hint {
            font-size: 0.85rem;
            color: var(--text-light);
            margin-top: 5px;
        }

        /* Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ø­ØµØµ */
        .day-title {
            color: var(--primary);
            margin: 25px 0 10px;
            border-right: 4px solid var(--primary);
            padding-right: 10px;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            font-weight: 700;
        }

        .classes-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
            gap: 18px;
            margin-bottom: 5px;
        }

        .class-item {
            background: white;
            border: 2px solid #e5e7eb;
            border-radius: var(--radius-lg);
            cursor: pointer;
            transition: var(--transition);
            overflow: hidden;
            box-shadow: var(--shadow-soft);
            display: flex;
            flex-direction: column;
        }

        .class-item:hover {
            border-color: var(--primary);
            transform: translateY(-3px);
            box-shadow: var(--shadow-medium);
        }

        .class-item.selected {
            border-color: var(--primary);
            box-shadow: var(--shadow-strong);
            position: relative;
        }

        .class-item.selected::after {
            content: 'âœ“ ØªÙ… Ø§Ù„Ø§Ø®ØªÙŠØ§Ø±';
            position: absolute;
            top: 10px;
            left: 10px;
            background: var(--success);
            color: white;
            padding: 4px 10px;
            border-radius: 999px;
            font-size: 0.8rem;
            font-weight: 700;
            box-shadow: 0 4px 10px rgba(16,185,129,0.4);
        }

        .class-media {
            position: relative;
            width: 100%;
            height: 150px;
            overflow: hidden;
        }

        .class-media img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: block;
            transform: scale(1.02);
            transition: var(--transition);
        }

        .class-item:hover .class-media img {
            transform: scale(1.06);
        }

        .class-media-badge {
            position: absolute;
            bottom: 8px;
            right: 8px;
            background: rgba(0,0,0,0.6);
            color: #fff;
            padding: 3px 10px;
            border-radius: 999px;
            font-size: 0.8rem;
        }

        .class-body {
            padding: 14px 16px 16px;
            display: flex;
            flex-direction: column;
            gap: 6px;
            flex: 1;
        }

        .class-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            gap: 8px;
        }

        .class-title {
            font-size: 1rem;
            color: var(--primary-dark);
            font-weight: 800;
        }

        .class-price {
            font-size: 1.1rem;
            font-weight: 800;
            color: var(--primary);
            white-space: nowrap;
        }

        .class-teacher {
            font-size: 0.9rem;
            color: var(--text-light);
            font-weight: 600;
        }

        .class-teacher i {
            color: var(--primary);
            margin-left: 4px;
        }

        .class-meta {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
            margin-top: 4px;
            font-size: 0.85rem;
            color: var(--text-light);
        }

        .class-chip {
            background: rgba(106,45,243,0.06);
            color: var(--primary-dark);
            padding: 3px 8px;
            border-radius: 999px;
            display: inline-flex;
            align-items: center;
            gap: 4px;
        }

        .class-chip i {
            font-size: 0.75rem;
        }

        .class-content {
            margin-top: 6px;
            font-size: 0.85rem;
            color: #6b7280;
        }

        /* Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ø¹Ø±ÙˆØ¶ */
        .offers-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
            gap: 20px;
            margin: 25px 0;
        }
        
        .offer-box {
            position: relative;
            background: white;
            border-radius: var(--radius-lg);
            padding: 20px;
            border: 2px solid;
            transition: var(--transition);
        }
        
        .offer-box.best {
            border-color: var(--primary);
            background: linear-gradient(135deg, rgba(106, 45, 243, 0.06), rgba(255, 138, 60, 0.04));
        }
        
        .offer-box.normal {
            border-color: var(--accent);
            background: rgba(34, 184, 170, 0.05);
        }
        
        .offer-badge {
            position: absolute;
            top: -10px;
            left: 20px;
            background: var(--orange-gradient);
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 700;
        }
        
        .offer-title {
            font-size: 1.2rem;
            font-weight: 800;
            color: var(--primary-dark);
            margin-bottom: 6px;
        }
        
        .price-large {
            font-size: 2rem;
            font-weight: 800;
            color: var(--primary);
            margin: 6px 0;
        }
        
        .price-small {
            font-size: 0.9rem;
            color: var(--text-light);
            text-decoration: line-through;
        }
        
        .savings-badge {
            background: var(--success);
            color: #fff;
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 0.8rem;
            display: inline-block;
            margin-top: 8px;
        }

        /* Ø§Ù„Ù…Ù„Ø®Øµ */
        .summary-card {
            background: var(--bg-light);
            border-radius: var(--radius-md);
            padding: 25px;
            margin-top: 20px;
        }

        .summary-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid rgba(0, 0, 0, 0.04);
            font-size: 0.95rem;
        }

        .summary-item:last-child {
            border-bottom: none;
        }

        .summary-item strong {
            color: var(--primary-dark);
        }

        .summary-highlight {
            font-weight: 800;
            color: var(--primary);
        }

        .summary-packs {
            font-size: 0.85rem;
            color: var(--text-light);
            margin-top: 5px;
        }

        /* Ø±ÙØ¹ Ø§Ù„Ù…Ù„Ù */
        .upload-area {
            border: 3px dashed #e5e7eb;
            border-radius: var(--radius-lg);
            padding: 40px;
            text-align: center;
            cursor: pointer;
            transition: var(--transition);
            margin: 20px 0;
        }

        .upload-area:hover {
            border-color: var(--primary);
            background: rgba(106, 45, 243, 0.02);
        }

        .upload-area.dragover {
            border-color: var(--primary);
            background: rgba(106, 45, 243, 0.05);
        }

        .upload-icon {
            font-size: 3rem;
            color: var(--primary);
            margin-bottom: 15px;
        }

        .upload-text {
            color: var(--text-dark);
            margin-bottom: 10px;
            font-weight: 600;
        }

        .upload-hint {
            color: var(--text-light);
            font-size: 0.9rem;
        }

        .file-preview {
            display: flex;
            align-items: center;
            justify-content: space-between;
            background: rgba(106, 45, 243, 0.05);
            padding: 15px;
            border-radius: var(--radius-md);
            margin-top: 15px;
        }

        .file-info {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .file-icon {
            color: var(--primary);
            font-size: 1.5rem;
        }

        .file-name {
            font-weight: 600;
            color: var(--text-dark);
        }

        .file-size {
            color: var(--text-light);
            font-size: 0.9rem;
        }

        .file-remove {
            background: none;
            border: none;
            color: var(--danger);
            cursor: pointer;
            font-size: 1.2rem;
        }

        /* Ø§Ù„Ø£Ø²Ø±Ø§Ø± */
        .form-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 40px;
            gap: 15px;
        }

        .btn {
            padding: 14px 30px;
            border-radius: var(--radius-md);
            border: none;
            font-family: 'Cairo', sans-serif;
            font-size: 1rem;
            font-weight: 700;
            cursor: pointer;
            transition: var(--transition);
            display: inline-flex;
            align-items: center;
            gap: 10px;
        }

        .btn-primary {
            background: var(--purple-gradient);
            color: white;
            box-shadow: var(--shadow-soft);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-medium);
        }

        .btn-secondary {
            background: transparent;
            color: var(--primary);
            border: 2px solid var(--primary);
        }

        .btn-secondary:hover {
            background: rgba(106, 45, 243, 0.05);
        }

        .btn-success {
            background: var(--success);
            color: white;
        }

        .btn-success:hover {
            background: #0da271;
            transform: translateY(-2px);
        }

        .btn-warning {
            background: var(--warning);
            color: white;
        }

        .btn-disabled {
            background: #e5e7eb;
            color: #9ca3af;
            cursor: not-allowed;
        }

        .btn-outline-whatsapp {
            background: #fff;
            color: #16a34a;
            border: 2px solid #16a34a;
        }

        .btn-outline-whatsapp:hover {
            background: #16a34a;
            color: #fff;
        }

        /* Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ */
        .message {
            padding: 20px;
            border-radius: var(--radius-md);
            margin: 20px 0;
            display: none;
            animation: slideIn 0.3s ease;
            font-size: 0.95rem;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .message.success {
            background: rgba(16, 185, 129, 0.1);
            border: 1px solid rgba(16, 185, 129, 0.2);
            color: var(--success);
        }

        .message.error {
            background: rgba(239, 68, 68, 0.1);
            border: 1px solid rgba(239, 68, 68, 0.2);
            color: var(--danger);
        }

        .message.info {
            background: rgba(106, 45, 243, 0.1);
            border: 1px solid rgba(106, 45, 243, 0.2);
            color: var(--primary);
        }

        /* Ø§Ù„ÙÙˆØªØ± */
        .footer {
            text-align: center;
            margin-top: 50px;
            padding-top: 20px;
            border-top: 1px solid #e5e7eb;
            color: var(--text-light);
            font-size: 0.9rem;
        }

        .contact-info {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-top: 15px;
            flex-wrap: wrap;
        }

        .contact-item {
            display: flex;
            align-items: center;
            gap: 8px;
            background: rgba(106, 45, 243, 0.05);
            padding: 10px 20px;
            border-radius: var(--radius-md);
        }

        .contact-item i {
            color: var(--primary);
        }

        .transfer-info {
            background: rgba(255, 138, 60, 0.1);
            border: 2px solid var(--secondary);
            border-radius: var(--radius-lg);
            padding: 25px;
            margin: 20px 0;
            text-align: center;
        }

        .transfer-number {
            font-size: 2rem;
            font-weight: 800;
            color: var(--primary-dark);
            margin: 15px 0;
            direction: ltr;
        }

        /* Ø§Ù„ØªØ­Ù…ÙŠÙ„ */
        .loader {
            display: none;
            text-align: center;
            padding: 30px;
        }

        .loader-spinner {
            width: 50px;
            height: 50px;
            border: 3px solid #e5e7eb;
            border-top: 3px solid var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 15px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Ù†Ø¬Ø§Ø­ Ø§Ù„ØªØ³Ø¬ÙŠÙ„ */
        .success-message {
            background: rgba(16, 185, 129, 0.08);
            border: 2px solid var(--success);
            border-radius: var(--radius-lg);
            padding: 30px;
            text-align: center;
            margin: 20px 0;
        }
        
        .success-icon {
            font-size: 4rem;
            color: var(--success);
            margin-bottom: 15px;
        }
        
        .reference-id {
            background: white;
            padding: 15px;
            border-radius: var(--radius-md);
            margin: 20px 0;
            border: 2px dashed var(--success);
            font-size: 1.1rem;
        }
        
        .reference-id strong {
            color: var(--text-dark);
            font-size: 1.3rem;
            direction: ltr;
            display: block;
            margin-top: 5px;
        }
        
        .action-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 25px;
            flex-wrap: wrap;
        }
        
        .registration-result {
            display: none;
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            .registration-card {
                padding: 24px;
            }
            .form-grid {
                grid-template-columns: 1fr;
            }
            .progress-steps {
                flex-wrap: wrap;
                justify-content: center;
                gap: 12px;
            }
            .form-buttons {
                flex-direction: column;
            }
            .btn {
                width: 100%;
                justify-content: center;
            }
            .classes-grid {
                grid-template-columns: 1fr;
            }
            .contact-info {
                flex-direction: column;
                align-items: center;
            }
            .action-buttons {
                flex-direction: column;
            }
            .action-buttons .btn {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Ø§Ù„Ù‡ÙŠØ¯Ø± -->
        <div class="header">
            <div class="logo">
                <div class="logo-img">
                    <img src="https://h.top4top.io/p_3622qldhs1.png" alt="Ø´Ø¹Ø§Ø± Ø£ÙƒØ§Ø¯ÙŠÙ…ÙŠØ© Ù…Ù„Ù‡Ù…">
                </div>
                <div class="logo-text">
                    <h1>Ø£ÙƒØ§Ø¯ÙŠÙ…ÙŠØ© Ù…Ù„Ù‡Ù… Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ©</h1>
                    <p>Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ Ù„Ù„Ø­ØµØµ Ø§Ù„Ø­Ø¶ÙˆØ±ÙŠØ©</p>
                    <div class="week-badge">Ø­ØµØµ Ù‡Ø°Ø§ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ ÙÙ‚Ø·</div>
                    <div class="dates-badge">
                        ğŸ—“ï¸ Ø§Ù„Ø¬Ù…Ø¹Ø© 12 Ø¯ÙŠØ³Ù…Ø¨Ø± &nbsp; Ùˆ &nbsp; Ø§Ù„Ø³Ø¨Øª 13 Ø¯ÙŠØ³Ù…Ø¨Ø±
                    </div>
                </div>
            </div>
        </div>

        <!-- Ø®Ø·ÙˆØ§Øª Ø§Ù„ØªÙ‚Ø¯Ù… -->
        <div class="progress-steps">
            <div class="progress-bar" id="progressBar"></div>
            <div class="step active" data-step="1">
                <div class="step-icon">1</div>
                <div class="step-label">Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø·Ø§Ù„Ø¨</div>
            </div>
            <div class="step" data-step="2">
                <div class="step-icon">2</div>
                <div class="step-label">Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø­ØµØµ</div>
            </div>
            <div class="step" data-step="3">
                <div class="step-icon">3</div>
                <div class="step-label">Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ù…Ø§Ù„ÙŠ</div>
            </div>
            <div class="step" data-step="4">
                <div class="step-icon">4</div>
                <div class="step-label">Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨</div>
            </div>
        </div>

        <!-- Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ù†Ø¸Ø§Ù… -->
        <div class="message success" id="successMessage">
            <i class="fas fa-check-circle"></i>
            <span id="successText"></span>
        </div>

        <div class="message error" id="errorMessage">
            <i class="fas fa-exclamation-circle"></i>
            <span id="errorText"></span>
        </div>

        <div class="message info" id="infoMessage">
            <i class="fas fa-info-circle"></i>
            <span id="infoText"></span>
        </div>

        <!-- Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ -->
        <div class="registration-card">
            <!-- Ø§Ù„Ø®Ø·ÙˆØ© 1: Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø·Ø§Ù„Ø¨ -->
            <div class="form-step active" id="step1">
                <div class="form-header">
                    <h2>Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø·Ø§Ù„Ø¨</h2>
                    <p>ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø·Ø§Ù„Ø¨ ÙƒØ§Ù…Ù„Ø© Ù„Ù„ØªØ³Ø¬ÙŠÙ„ ÙÙŠ Ø§Ù„Ø­ØµØµ Ø§Ù„Ø­Ø¶ÙˆØ±ÙŠØ©.</p>
                </div>

                <div class="transfer-info" style="text-align:right;">
                    <h3><i class="fas fa-bullhorn"></i> ØªÙ†Ø¨ÙŠÙ‡ Ù…Ù‡Ù… Ù„Ù„Ø·Ù„Ø¨Ø© Ùˆ Ø£ÙˆÙ„ÙŠØ§Ø¡ Ø§Ù„Ø£Ù…ÙˆØ±</h3>
                    <p style="margin-top:8px;">
                        Ø§Ù„Ø­ØµØµ Ø§Ù„Ø­Ø¶ÙˆØ±ÙŠØ© ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„Ù†Ø¸Ø§Ù… Ø®Ø§ØµØ© Ø¨Ø§Ù„Ø£ÙŠØ§Ù…:
                    </p>
                    <ul style="list-style:none; margin:10px 0; padding:0; color:var(--text-dark);">
                        <li>ğŸ“ Ø§Ù„Ø¬Ù…Ø¹Ø© 12 Ø¯ÙŠØ³Ù…Ø¨Ø±</li>
                        <li>ğŸ“ Ø§Ù„Ø³Ø¨Øª 13 Ø¯ÙŠØ³Ù…Ø¨Ø±</li>
                    </ul>
                    <p style="font-size:0.9rem; color:var(--text-light); margin-top:6px;">
                        Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø¥Ù…ÙƒØ§Ù†ÙŠØ© Ø§Ù„Ø­Ø¶ÙˆØ± ÙÙŠ Ø§Ù„Ø£ÙˆÙ‚Ø§Øª Ø§Ù„Ù…Ø®ØªØ§Ø±Ø© Ù‚Ø¨Ù„ Ø¥ØªÙ…Ø§Ù… Ø§Ù„ØªØ³Ø¬ÙŠÙ„.
                    </p>
                </div>

                <form id="basicInfoForm">
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="studentName" class="required">Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨ ÙƒØ§Ù…Ù„Ø§Ù‹</label>
                            <input type="text" id="studentName" name="studentName" placeholder="Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø«Ù„Ø§Ø«ÙŠ ÙˆØ§Ù„Ù‚Ø¨ÙŠÙ„Ø©" required>
                            <div class="error-message" id="studentNameError"></div>
                        </div>

                        <div class="form-group">
                            <label for="grade" class="required">Ø§Ù„ØµÙ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ</label>
                            <select id="grade" name="grade" required>
                                <option value="">Ø§Ø®ØªØ± Ø§Ù„ØµÙ</option>
                                 <option value="Ø§Ù„Ø®Ø§Ù…Ø³">Ø§Ù„Ø®Ø§Ù…Ø³/option>
                                <option value="Ø§Ù„Ø³Ø§Ø¯Ø³">Ø§Ù„Ø³Ø§Ø¯Ø³</option>
                                <option value="Ø§Ù„Ø³Ø§Ø¨Ø¹">Ø§Ù„Ø³Ø§Ø¨Ø¹</option>
                                <option value="Ø§Ù„Ø«Ø§Ù…Ù†">Ø§Ù„Ø«Ø§Ù…Ù†</option>
                                <option value="Ø§Ù„ØªØ§Ø³Ø¹">Ø§Ù„ØªØ§Ø³Ø¹</option>
                                <option value="Ø§Ù„Ø¹Ø§Ø´Ø±">Ø§Ù„Ø¹Ø§Ø´Ø±</option>
                                <option value="Ø§Ù„Ø­Ø§Ø¯ÙŠ Ø¹Ø´Ø±">Ø§Ù„Ø­Ø§Ø¯ÙŠ Ø¹Ø´Ø±</option>
                                <option value="Ø§Ù„Ø«Ø§Ù†ÙŠ Ø¹Ø´Ø±">Ø§Ù„Ø«Ø§Ù†ÙŠ Ø¹Ø´Ø±</option>
                            </select>
                            <div class="error-message" id="gradeError"></div>
                        </div>

                        <div class="form-group">
                            <label for="phone" class="required">Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ (ÙˆØ§ØªØ³Ø§Ø¨)</label>
                            <input type="tel" id="phone" name="phone" placeholder="95xxxxxx9" required>
                            <div class="error-message" id="phoneError"></div>
                            <div class="form-hint">Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ Ø§Ù„Ù…Ø±ØªØ¨Ø· Ø¨Ø­Ø³Ø§Ø¨ Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨ Ù„Ù„ØªÙˆØ§ØµÙ„ ÙˆØ§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª.</div>
                        </div>

                        <div class="form-group">
                            <label for="email">Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
                            <input type="email" id="email" name="email" placeholder="example@email.com">
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="notes">Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
                        <textarea id="notes" name="notes" rows="3" placeholder="Ø£ÙŠ Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø®Ø§ØµØ© Ø¨Ø§Ù„Ø·Ø§Ù„Ø¨ Ø£Ùˆ Ø§Ø­ØªÙŠØ§Ø¬Ø§Øª ØªØ¹Ù„ÙŠÙ…ÙŠØ©..."></textarea>
                    </div>

                    <div class="form-buttons">
                        <button type="button" class="btn btn-secondary" disabled>Ø§Ù„Ø³Ø§Ø¨Ù‚</button>
                        <button type="button" class="btn btn-primary" onclick="nextStep()">
                            Ø§Ù„ØªØ§Ù„ÙŠ <i class="fas fa-arrow-left"></i>
                        </button>
                    </div>
                </form>
            </div>

            <!-- Ø§Ù„Ø®Ø·ÙˆØ© 2: Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø­ØµØµ -->
            <div class="form-step" id="step2">
                <div class="form-header">
                    <h2>Ø§Ø®ØªØ± Ø§Ù„Ø­ØµØµ Ø§Ù„Ø­Ø¶ÙˆØ±ÙŠØ©</h2>
                    <p>
                        ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ø®ØªÙŠØ§Ø± Ø­ØµØ© ÙˆØ§Ø­Ø¯Ø© Ø£Ùˆ Ø£ÙƒØ«Ø±ØŒ ÙˆØ³ÙŠØªÙ… ØªØ·Ø¨ÙŠÙ‚ Ø£ÙØ¶Ù„ Ø¹Ø±Ø¶ ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§ ÙˆÙÙ‚ Ø¹Ø¯Ø¯ Ø§Ù„Ø­ØµØµ Ø§Ù„Ù…Ø®ØªØ§Ø±Ø©.
                    </p>
                </div>

                <!-- Ø§Ù„Ø¹Ø±ÙˆØ¶ -->
                <div class="offers-container">
                    <div class="offer-box best">
                        <div class="offer-badge">Ø§Ù„Ø£ÙƒØ«Ø± ØªÙˆÙÙŠØ±Ø§Ù‹</div>
                        <div class="offer-title">Ø¨Ø§Ù‚Ø© Ù¦ Ø­ØµØµ</div>
                        <div class="price-large">20 <span style="font-size:1rem;">Ø±ÙŠØ§Ù„</span></div>
                        <div class="price-small">Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† 30 Ø±ÙŠØ§Ù„</div>
                        <div class="savings-badge">ØªÙˆÙÙŠØ± 10 Ø±ÙŠØ§Ù„Ø§Øª</div>
                        <p style="margin-top:10px; font-size:0.9rem; color:var(--text-light);">
                            Ù…Ø«Ø§Ù„ÙŠØ© Ù„Ù„Ø·Ø§Ù„Ø¨ Ø§Ù„Ø°ÙŠ ÙŠØ±ÙŠØ¯ Ø§Ù„Ø§Ø³ØªÙØ§Ø¯Ø© Ù…Ù† Ø£ØºÙ„Ø¨ Ø§Ù„Ø­ØµØµ Ø§Ù„Ù…ØªØ§Ø­Ø©.
                        </p>
                    </div>

                    <div class="offer-box normal">
                        <div class="offer-title">Ø¨Ø§Ù‚Ø© Ù¥ Ø­ØµØµ</div>
                        <div class="price-large">18 <span style="font-size:1rem;">Ø±ÙŠØ§Ù„</span></div>
                        <div class="price-small">Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† 25 Ø±ÙŠØ§Ù„</div>
                        <div class="savings-badge">ØªÙˆÙÙŠØ± 7 Ø±ÙŠØ§Ù„Ø§Øª</div>
                        <p style="margin-top:10px; font-size:0.9rem; color:var(--text-light);">
                            Ø§Ø®ØªÙŠØ§Ø± Ù…Ø±Ù† Ù„Ø¹Ø¯Ø© Ù…ÙˆØ§Ø¯ Ù…Ø¹ ØªÙˆÙÙŠØ± Ù…Ù…ØªØ§Ø².
                        </p>
                    </div>

                    <div class="offer-box normal">
                        <div class="offer-title">Ù£ Ø£Ùˆ Ù¤ Ø­ØµØµ</div>
                        <p style="font-size:0.9rem; color:var(--text-light); margin-bottom:6px;">
                            Ù¤ Ø­ØµØµ = 15 Ø±ÙŠØ§Ù„ (Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† 20)  
                            <br>Ù£ Ø­ØµØµ = 12 Ø±ÙŠØ§Ù„ (Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† 15)
                        </p>
                        <div class="savings-badge">ÙŠØªÙ… Ø§Ø­ØªØ³Ø§Ø¨ Ø§Ù„Ø®ØµÙ… ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹</div>
                    </div>
                </div>

                <!-- Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø­ØµØµ -->
                <h3 style="color: var(--primary-dark); margin: 15px 0 10px;">
                    Ø§Ù„Ø­ØµØµ Ø§Ù„Ù…ØªØ§Ø­Ø© (Ø³Ø¹Ø± Ø§Ù„Ø­ØµØ© Ø§Ù„Ù…ÙØ±Ø¯Ø© 5 Ø±ÙŠØ§Ù„Ø§Øª):
                </h3>

                <div id="classesContainer"></div>

                <!-- Ù…Ù„Ø®Øµ Ø§Ù„Ø§Ø®ØªÙŠØ§Ø±Ø§Øª -->
                <div class="summary-card">
                    <h3 style="color: var(--primary-dark); margin-bottom: 10px;">
                        <i class="fas fa-clipboard-list"></i> Ù…Ù„Ø®Øµ Ø§Ù„Ø§Ø®ØªÙŠØ§Ø±Ø§Øª
                    </h3>
                    <div class="summary-item">
                        <span>Ø¹Ø¯Ø¯ Ø§Ù„Ø­ØµØµ Ø§Ù„Ù…Ø®ØªØ§Ø±Ø©:</span>
                        <span id="selectedCount">0</span>
                    </div>
                    <div class="summary-item">
                        <span>Ø§Ù„Ø³Ø¹Ø± Ø¨Ø¯ÙˆÙ† Ø¹Ø±ÙˆØ¶ (5 Ø±ÙŠØ§Ù„ Ù„Ù„Ø­ØµØ©):</span>
                        <span id="normalTotal">0 Ø±ÙŠØ§Ù„</span>
                    </div>
                    <div class="summary-item">
                        <span>Ù‚ÙŠÙ…Ø© Ø§Ù„Ø®ØµÙ…:</span>
                        <span id="discountValue">0 Ø±ÙŠØ§Ù„</span>
                    </div>
                    <div class="summary-item">
                        <span>Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ Ø¨Ø¹Ø¯ Ø§Ù„Ø®ØµÙ…:</span>
                        <span id="finalAmount" class="summary-highlight">0 Ø±ÙŠØ§Ù„</span>
                    </div>
                    <div class="summary-item">
                        <span>Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø·Ø¨Ù‚:</span>
                        <span id="offerLabel">Ù„Ø§ ÙŠÙˆØ¬Ø¯</span>
                    </div>
                    <div class="summary-packs" id="packsBreakdown" style="display:none;"></div>
                </div>

                <div class="form-buttons">
                    <button type="button" class="btn btn-secondary" onclick="prevStep()">
                        <i class="fas fa-arrow-right"></i> Ø§Ù„Ø³Ø§Ø¨Ù‚
                    </button>
                    <button type="button" class="btn btn-primary" onclick="nextStep()">
                        Ø§Ù„ØªØ§Ù„ÙŠ <i class="fas fa-arrow-left"></i>
                    </button>
                </div>
            </div>

            <!-- Ø§Ù„Ø®Ø·ÙˆØ© 3: Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ù…Ø§Ù„ÙŠ -->
            <div class="form-step" id="step3">
                <div class="form-header">
                    <h2>Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ù…Ø§Ù„ÙŠ</h2>
                    <p>Ù‚Ù… Ø¨Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„ØªØ§Ù„ÙŠ Ø«Ù… Ø§Ø±ÙØ¹ ØµÙˆØ±Ø© Ø¥Ø´Ø¹Ø§Ø± Ø§Ù„ØªØ­ÙˆÙŠÙ„.</p>
                </div>

                <div class="transfer-info">
                    <h3><i class="fas fa-money-bill-wave"></i> Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ØªØ­ÙˆÙŠÙ„</h3>
                    <p>ÙŠØ±Ø¬Ù‰ ØªØ­ÙˆÙŠÙ„ <strong id="paymentAmountLabel">Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ</strong> Ø¹Ù„Ù‰ Ø§Ù„Ø±Ù‚Ù…:</p>
                    <div class="transfer-number">92147179</div>
                    <p>Ø«Ù… Ù‚Ù… Ø¨Ø±ÙØ¹ ØµÙˆØ±Ø© Ø¥Ø´Ø¹Ø§Ø± Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ø£Ø¯Ù†Ø§Ù‡.</p>
                    <p style="color: var(--warning); margin-top: 10px; font-size:0.9rem;">
                        <i class="fas fa-exclamation-triangle"></i>
                        ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø­ÙˆÙ„ Ù…Ø·Ø§Ø¨Ù‚ Ù„Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ Ø§Ù„Ø¸Ø§Ù‡Ø± ÙÙŠ Ø§Ù„Ù…Ù„Ø®Øµ.
                    </p>
                </div>

                <div class="form-group">
                    <label class="required">Ø±ÙØ¹ Ø¥Ø´Ø¹Ø§Ø± Ø§Ù„ØªØ­ÙˆÙŠÙ„</label>
                    <div class="upload-area" id="uploadArea" onclick="document.getElementById('receiptFile').click()">
                        <div class="upload-icon">
                            <i class="fas fa-cloud-upload-alt"></i>
                        </div>
                        <div class="upload-text">Ø§Ù†Ù‚Ø± Ù„Ø±ÙØ¹ ØµÙˆØ±Ø© Ø¥Ø´Ø¹Ø§Ø± Ø§Ù„ØªØ­ÙˆÙŠÙ„</div>
                        <div class="upload-hint">ÙŠÙØ³Ù…Ø­ Ø¨Ø§Ù„ØµÙŠØº: JPG, PNG, PDF (Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰: 5MB)</div>
                    </div>
                    <input type="file" id="receiptFile" name="receiptFile" accept="image/*,.pdf" style="display:none;" onchange="handleFileUpload(this.files)">
                    <div class="error-message" id="receiptError"></div>
                    <div id="filePreview" style="display:none;"></div>
                </div>

                <div class="form-hint" style="background: rgba(245,158,11,0.08); padding:15px; border-radius:var(--radius-md); font-size:0.9rem;">
                    <strong style="color:var(--warning);"><i class="fas fa-info-circle"></i> Ù…Ù„Ø§Ø­Ø¸Ø§Øª:</strong>
                    <br>1. Ø§Ø­Ø±Øµ Ø£Ù† ØªÙƒÙˆÙ† ØµÙˆØ±Ø© Ø§Ù„Ø¥ÙŠØµØ§Ù„ ÙˆØ§Ø¶Ø­Ø©.
                    <br>2. Ø³ÙŠØªÙ… Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„ØªØ­ÙˆÙŠÙ„ ÙˆØ§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹ÙƒÙ… Ø¹Ø¨Ø± Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨ Ù„Ù„ØªØ£ÙƒÙŠØ¯.
                </div>

                <div class="form-buttons">
                    <button type="button" class="btn btn-secondary" onclick="prevStep()">
                        <i class="fas fa-arrow-right"></i> Ø§Ù„Ø³Ø§Ø¨Ù‚
                    </button>
                    <button type="button" class="btn btn-primary" onclick="nextStep()">
                        Ø§Ù„ØªØ§Ù„ÙŠ <i class="fas fa-arrow-left"></i>
                    </button>
                </div>
            </div>

            <!-- Ø§Ù„Ø®Ø·ÙˆØ© 4: ØªØ£ÙƒÙŠØ¯ Ø§Ù„ØªØ³Ø¬ÙŠÙ„ -->
            <div class="form-step" id="step4">
                <div class="form-header">
                    <h2>ØªØ£ÙƒÙŠØ¯ Ø§Ù„ØªØ³Ø¬ÙŠÙ„ ÙˆØ¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨</h2>
                    <p>ÙŠØ±Ø¬Ù‰ Ù…Ø±Ø§Ø¬Ø¹Ø© Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù‚Ø¨Ù„ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ.</p>
                </div>

                <div id="registrationResult" class="registration-result"></div>

                <div id="summaryBeforeSubmit">
                    <div class="summary-card">
                        <h3 style="color: var(--primary-dark); margin-bottom: 12px; display:flex; align-items:center; gap:8px;">
                            <i class="fas fa-clipboard-check"></i> Ù…Ù„Ø®Øµ Ø§Ù„Ø·Ù„Ø¨
                        </h3>
                        
                        <div class="summary-item">
                            <span>Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨:</span>
                            <span id="summaryName">-</span>
                        </div>
                        <div class="summary-item">
                            <span>Ø§Ù„ØµÙ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ:</span>
                            <span id="summaryGrade">-</span>
                        </div>
                        <div class="summary-item">
                            <span>Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ:</span>
                            <span id="summaryPhone">-</span>
                        </div>
                        <div class="summary-item">
                            <span>Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ:</span>
                            <span id="summaryEmail">Ù„Ù… ÙŠØªÙ… Ø¥Ø¯Ø®Ø§Ù„Ù‡</span>
                        </div>
                        <div class="summary-item" style="border-top:2px solid var(--primary-light); padding-top:10px; margin-top:8px;">
                            <span>Ø§Ù„Ø­ØµØµ Ø§Ù„Ù…Ø®ØªØ§Ø±Ø©:</span>
                            <span id="summaryClasses">-</span>
                        </div>
                        <div class="summary-item">
                            <span>Ø¹Ø¯Ø¯ Ø§Ù„Ø­ØµØµ:</span>
                            <span id="summaryCount">-</span>
                        </div>
                        <div class="summary-item">
                            <span>Ø§Ù„Ø³Ø¹Ø± Ø¨Ø¯ÙˆÙ† Ø¹Ø±ÙˆØ¶:</span>
                            <span id="summaryTotal">-</span>
                        </div>
                        <div class="summary-item">
                            <span>Ù‚ÙŠÙ…Ø© Ø§Ù„Ø®ØµÙ…:</span>
                            <span id="summaryDiscountAmount">-</span>
                        </div>
                        <div class="summary-item">
                            <span>Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ:</span>
                            <span id="summaryFinal" class="summary-highlight">-</span>
                        </div>
                        <div class="summary-item">
                            <span>Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø·Ø¨Ù‚:</span>
                            <span id="summaryOfferLabel">-</span>
                        </div>
                        <div class="summary-item">
                            <span>Ø­Ø§Ù„Ø© Ø§Ù„ØªØ­ÙˆÙŠÙ„:</span>
                            <span id="summaryPayment" style="color: var(--success);">âœ“ ØªÙ… Ø±ÙØ¹ Ø§Ù„Ø¥ÙŠØµØ§Ù„</span>
                        </div>
                    </div>

                    <div class="form-group" style="margin: 25px 0;">
                        <div style="background: rgba(106, 45, 243, 0.05); padding: 18px; border-radius: var(--radius-md); font-size:0.9rem;">
                            <h4 style="color: var(--primary-dark); margin-bottom: 10px;">Ø§Ù„Ø´Ø±ÙˆØ· ÙˆØ§Ù„Ø£Ø­ÙƒØ§Ù…:</h4>
                            <ul style="list-style:none; margin-right:10px; color:var(--text-light); padding:0;">
                                <li style="margin-bottom:6px;">
                                    <i class="fas fa-check-circle" style="color:var(--accent); margin-left:6px;"></i>
                                    Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­ØµØµ Ø­Ø¶ÙˆØ±ÙŠØ© Ø¨Ù…Ù‚Ø± Ø£ÙƒØ§Ø¯ÙŠÙ…ÙŠØ© Ù…Ù„Ù‡Ù….
                                </li>
                                <li style="margin-bottom:6px;">
                                    <i class="fas fa-check-circle" style="color:var(--accent); margin-left:6px;"></i>
                                    ÙŠÙ„ØªØ²Ù… Ø§Ù„Ø·Ø§Ù„Ø¨ Ø¨Ø§Ù„Ø­Ø¶ÙˆØ± ÙÙŠ Ø§Ù„ØªÙˆÙ‚ÙŠØª Ø§Ù„Ø°ÙŠ ØªÙ… Ø§Ø®ØªÙŠØ§Ø±Ù‡.
                                </li>
                                <li style="margin-bottom:6px;">
                                    <i class="fas fa-check-circle" style="color:var(--accent); margin-left:6px;"></i>
                                    Ø§Ù„ØªØ³Ø¬ÙŠÙ„ Ù†Ù‡Ø§Ø¦ÙŠ Ø¨Ø¹Ø¯ ØªØ£ÙƒÙŠØ¯ Ø§Ù„ØªØ­ÙˆÙŠÙ„ ÙˆÙ„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ø³ØªØ±Ø¬Ø§Ø¹ Ø§Ù„Ù…Ø¨Ù„Øº.
                                </li>
                                <li style="margin-bottom:6px;">
                                    <i class="fas fa-check-circle" style="color:var(--accent); margin-left:6px;"></i>
                                    ÙŠÙ…ÙƒÙ† ØªØ¹Ø¯ÙŠÙ„ Ø¨Ø¹Ø¶ Ø§Ù„Ø£ÙˆÙ‚Ø§Øª Ø£Ùˆ Ø§Ù„Ù…Ø¹Ù„Ù…ÙŠÙ† Ø¹Ù†Ø¯ Ø§Ù„Ø¶Ø±ÙˆØ±Ø© Ù…Ø¹ Ø¥Ø¨Ù„Ø§ØºÙƒÙ… Ø¨Ø°Ù„Ùƒ.
                                </li>
                            </ul>
                        </div>
                    </div>

                    <div class="form-group">
                        <label style="display:flex; align-items:center; gap:10px; cursor:pointer;">
                            <input type="checkbox" id="agreeTerms" name="agreeTerms" style="width:auto;">
                            <span>Ø£Ù‚Ø± Ø¨Ø£Ù† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ØµØ­ÙŠØ­Ø©ØŒ ÙˆØ£ÙˆØ§ÙÙ‚ Ø¹Ù„Ù‰ Ø§Ù„Ø´Ø±ÙˆØ· ÙˆØ§Ù„Ø£Ø­ÙƒØ§Ù… Ø§Ù„Ù…Ø°ÙƒÙˆØ±Ø© Ø£Ø¹Ù„Ø§Ù‡.</span>
                        </label>
                        <div class="error-message" id="termsError"></div>
                    </div>

                    <div class="loader" id="loader">
                        <div class="loader-spinner"></div>
                        <p id="loaderText">Ø¬Ø§Ø±ÙŠ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨...</p>
                    </div>

                    <div class="form-buttons">
                        <button type="button" class="btn btn-secondary" onclick="prevStep()">
                            <i class="fas fa-arrow-right"></i> Ø§Ù„Ø³Ø§Ø¨Ù‚
                        </button>
                        <button type="button" class="btn btn-success" onclick="submitRegistration()" id="submitBtn">
                            <i class="fas fa-paper-plane"></i> Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Ø£Ø²Ø±Ø§Ø± ØªØ­ÙƒÙ… Ø¹Ø§Ù…Ø© -->
        <div style="text-align:center; margin: 25px 0;">
            <button onclick="testGoogleSheetsConnection()" class="btn btn-warning" style="margin:5px;">
                <i class="fas fa-wifi"></i> Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù€ Google Sheets
            </button>
            <button onclick="resetForm()" class="btn btn-secondary" style="margin:5px;">
                <i class="fas fa-redo"></i> Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
            </button>
        </div>

        <!-- Ø§Ù„ÙÙˆØªØ± -->
        <div class="footer">
            <div class="contact-info">
                <div class="contact-item">
                    <i class="fas fa-phone-alt"></i>
                    <span>Ù„Ù„ØªÙˆØ§ØµÙ„: 74120010</span>
                </div>
                <div class="contact-item">
                    <i class="fas fa-money-bill-wave"></i>
                    <span>Ø±Ù‚Ù… Ø§Ù„ØªØ­ÙˆÙŠÙ„: 92147179</span>
                </div>
                <div class="contact-item">
                    <i class="fas fa-map-marker-alt"></i>
                    <span>Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø£ÙƒØ§Ø¯ÙŠÙ…ÙŠØ©: Ø¹Ø¨Ø±ÙŠ - Ø§Ù„Ø¯Ø±ÙŠØ²</span>
                </div>
                <div class="contact-item">
                    <i class="fas fa-clock"></i>
                    <span>Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ø¹Ù…Ù„: 8 ØµØ¨Ø§Ø­Ø§Ù‹ - 10 Ù…Ø³Ø§Ø¡Ù‹</span>
                </div>
            </div>
            <p style="margin-top:15px;">
                Â© 2025 Ø£ÙƒØ§Ø¯ÙŠÙ…ÙŠØ© Ù…Ù„Ù‡Ù… Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ© - Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©.
                <br>Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ Ù„Ù„Ø­ØµØµ Ø§Ù„Ø­Ø¶ÙˆØ±ÙŠØ© - Ø§Ù„Ø¥ØµØ¯Ø§Ø± 4.0
            </p>
        </div>
    </div>

    <script>
        // ================= Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø£Ø³Ø§Ø³ÙŠØ© =================
        // ØºÙŠÙ‘Ø± Ø§Ù„Ø±Ø§Ø¨Ø· Ù‡Ù†Ø§ Ù„Ùˆ ÙƒÙ†Øª ØªØ³ØªØ®Ø¯Ù… Web App Ù…Ø®ØªÙ„Ù
        const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbzFEDcwLFvlG78McDYgjWDEKyMJSdxft1IfOPo9cjGOXSPd2vhO3qlhCw5smR9QgBAUgA/exec';

        // Ø£Ø³Ø¹Ø§Ø± Ø§Ù„Ø¨Ø§Ù‚Ø§Øª
        const PACKS = [
            { size: 6, price: 20, label: 'Ø¹Ø±Ø¶ 6 Ø­ØµØµ Ø¨Ù€ 20 Ø±ÙŠØ§Ù„' },
            { size: 5, price: 18, label: 'Ø¹Ø±Ø¶ 5 Ø­ØµØµ Ø¨Ù€ 18 Ø±ÙŠØ§Ù„' },
            { size: 4, price: 15, label: 'Ø¹Ø±Ø¶ 4 Ø­ØµØµ Ø¨Ù€ 15 Ø±ÙŠØ§Ù„' },
            { size: 3, price: 12, label: 'Ø¹Ø±Ø¶ 3 Ø­ØµØµ Ø¨Ù€ 12 Ø±ÙŠØ§Ù„' },
            { size: 2, price: 8,  label: 'Ø¹Ø±Ø¶ Ø­ØµØªÙŠÙ† Ø¨Ù€ 8 Ø±ÙŠØ§Ù„' },
            { size: 1, price: 5,  label: 'Ø­ØµØ© Ù…ÙØ±Ø¯Ø© Ø¨Ù€ 5 Ø±ÙŠØ§Ù„' }
        ];

        const DEFAULT_IMAGE = 'https://via.placeholder.com/600x350.png?text=%D8%A3%D9%83%D8%A7%D8%AF%D9%8A%D9%85%D9%8A%D8%A9+%D9%85%D9%84%D9%87%D9%85';

        const TEACHER_IMAGES = {
          "Ù…Ø­Ù…Ø¯ Ø§Ù„Ù…Ø²Ø±ÙˆØ¹ÙŠ": "https://l.top4top.io/p_3629amzq27.jpeg",
          "Ø£Ø­Ù…Ø¯ Ø§Ù„Ù…Ø¹Ù…Ø±ÙŠ": "https://d.top4top.io/p_3630vvr721.jpeg",
          "Ø£Ø­Ù…Ø¯ Ø§Ù„Ù…Ø¹Ù…Ø±ÙŠ": "https://d.top4top.io/p_3630vvr721.jpeg",
          "Ø¯Ø±ÙˆÙŠØ´ Ø§Ù„ØºØ§ÙØ±ÙŠ": "https://g.top4top.io/p_36298w5k72.jpeg",
          "Ø¨Ø¯Ø± Ø§Ù„Ø¹Ø¨Ø±ÙŠ": "https://h.top4top.io/p_3629jyv2s3.jpeg",
          "Ø®Ù„ÙŠÙØ© Ø§Ù„Ù…Ø¹Ù…Ø±ÙŠ": "https://i.top4top.io/p_3629deyyc4.jpeg",
          "Ø¹Ù…Ø± Ø§Ù„ØºØ§ÙØ±ÙŠ": "https://k.top4top.io/p_3629bqmrj6.jpeg",
         "Ø®Ù„ÙŠÙØ© Ø§Ù„Ù…Ø¹Ù…Ø±ÙŠ": "https://i.top4top.io/p_3629deyyc4.jpeg",
        "Ø®Ù„ÙŠÙØ© Ø§Ù„Ù…Ø¹Ù…Ø±ÙŠ": "https://i.top4top.io/p_3629deyyc4.jpeg",
        "Ø®Ù„ÙŠÙØ© Ø§Ù„Ù…Ø¹Ù…Ø±ÙŠ": "https://i.top4top.io/p_3629deyyc4.jpeg",
          "Ø®Ù„ÙŠÙØ© Ø§Ù„Ù…Ø¹Ù…Ø±ÙŠ": "https://i.top4top.io/p_3629deyyc4.jpeg",
         "Ø®Ù„ÙŠÙØ© Ø§Ù„Ù…Ø¹Ù…Ø±ÙŠ": "https://i.top4top.io/p_3629deyyc4.jpeg",
          "Ø¹Ù…Ø± Ø§Ù„ØºØ§ÙØ±ÙŠ": "https://k.top4top.io/p_3629bqmrj6.jpeg"
        };

        // Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­ØµØµ (Ù…Ù† Ù…Ù„Ù Excel)
        const CLASSES = [
          {
            "id": "class_1",
            "teacher": "Ø³Ø¹ÙŠØ¯ Ø§Ù„ÙƒÙ„Ø¨Ø§Ù†ÙŠ",
            "day": "Ø§Ù„Ø¬Ù…Ø¹Ø©",
            "time": "9:00 - 10:30 Øµ",
            "stage": "Ø§Ù„ØµÙ Ø§Ù„Ø­Ø§Ø¯ÙŠ Ø¹Ø´Ø±",
            "subject": "Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠØ§Øª Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø© ",
            "content": "Ù…Ø±Ø§Ø¬Ø¹Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ Ø§Ù„ØªØ±ÙƒÙŠØ² Ø¹Ù„Ù‰ Ø§Ù„ÙˆØ­Ø¯ØªÙŠÙ† Ø§Ù„Ø£ÙˆÙ„Ù‰ ÙˆØ§Ù„Ø«Ø§Ù†ÙŠØ©",
            "price": 5
          },
          {
            "id": "class_2",
            "teacher": "Ø£Ø­Ù…Ø¯ Ø§Ù„Ù…Ø¹Ù…Ø±ÙŠ",
            "day": "Ø§Ù„Ø¬Ù…Ø¹Ø©",
            "time": "4:00 - 5:30 Ù…",
            "stage": "Ø§Ù„ØµÙ Ø§Ù„Ø«Ø§Ù†ÙŠ Ø¹Ø´Ø±",
            "subject": "Ø§Ù„ÙƒÙŠÙ…ÙŠØ§Ø¡",
            "content": "Ù…Ø±Ø§Ø¬Ø¹Ø© Ø¹Ù„Ù‰ Ø§Ù„ÙˆØ­Ø¯Ø© 1 ( Ø´Ø±Ø­ Ùˆ ØªØ¯Ø±ÙŠØ¨ Ø¹Ù„Ù‰ Ø£ÙÙƒØ§Ø± Ø§Ù…ØªØ­Ø§Ù†Ø§Øª Ù†Ù‡Ø§ÙŠØ© Ø§Ù„ÙØµÙ„ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ Ø§Ù„Ø£ÙˆÙ„ Ù…Ù† ÙˆØ§Ù‚Ø¹ Ù†Ù…Ø§Ø°Ø¬ Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø³Ø§Ø¨Ù‚Ø© )",
            "price": 5
          },
          {
            "id": "class_3",
            "teacher": "Ø£Ø­Ù…Ø¯ Ø§Ù„Ù…Ø¹Ù…Ø±ÙŠ",
            "day": "Ø§Ù„Ø¬Ù…Ø¹Ø©",
            "time": "6:00 - 7:30 Ù…",
            "stage": "Ø§Ù„ØµÙ Ø§Ù„Ø«Ø§Ù†ÙŠ Ø¹Ø´Ø±",
            "subject": "Ø§Ù„ÙƒÙŠÙ…ÙŠØ§Ø¡",
            "content": "Ù…Ø±Ø§Ø¬Ø¹Ø© Ø¹Ø§Ù…Ø© Ù„Ù„ÙˆØ­Ø¯Ø© Ø§Ù„Ø±Ø§Ø¨Ø¹Ø© ØªØªØ¶Ù…Ù† Ù…Ù†Ø§Ù‚Ø´Ø© Ø£ÙÙƒØ§Ø± Ø§Ù„ÙˆØ­Ø¯Ø© Ùˆ Ø¹Ø±Ø¶ Ù…Ø®Ø·Ø·Ø§Øª Ø§Ù„ØªÙØ§Ø¹Ù„Ø§Øª Ø§Ù„Ø¹Ø¶ÙˆÙŠØ© Ùˆ Ø­Ù„ Ø£Ø³Ø¦Ù„Ø© Ù†Ù‡Ø§ÙŠØ© Ø§Ù„ÙˆØ­Ø¯Ø© Ùˆ Ø£Ø³Ø¦Ù„Ø© Ø§Ù„Ø§Ù…ØªØ­Ø§Ù†Ø§Øª Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ© Ø¨Ø·Ø±Ù‚ Ù…Ø®ØªÙ„ÙØ© ÙˆØ£Ø³Ø§Ù„ÙŠØ¨ Ù…ØªÙ†ÙˆØ¹Ø©",
            "price": 5
          },
          {
            "id": "class_4",
            "teacher": "Ø¥Ø¨Ø±Ø§Ù‡ÙŠÙ… Ø§Ù„Ù…Ù‚Ø¨Ø§Ù„ÙŠ",
            "day": "Ø§Ù„Ø¬Ù…Ø¹Ø©",
            "time": "6:00 - 7:30 Ù…",
            "stage": "Ø§Ù„ØµÙ Ø§Ù„Ø¹Ø§Ø´Ø±",
            "subject": "Ø§Ù„ÙÙŠØ²ÙŠØ§Ø¡",
            "content": "Ù…Ø±Ø§Ø¬Ø¹Ø© Ø´Ø§Ù…Ù„Ø© Ù„Ù„Ø§Ù…ØªØ­Ø§Ù† Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ ÙÙŠ Ø§Ù„ÙØµÙ„ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ Ø§Ù„Ø£ÙˆÙ„ ( ØªØ¯Ø±ÙŠØ¨Ø§Øª Ù…ÙƒØ«ÙØ© Ùˆ Ø§Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ø£Ø³Ø¦Ù„Ø© Ø§Ù„Ø§Ù…ØªØ­Ø§Ù†Ø§Øª Ø§Ù„Ø³Ø§Ø¨Ù‚Ø© )",
            "price": 5
          },
          {
            "id": "class_5",
           "teacher": "Ø®Ù„ÙŠÙØ© Ø§Ù„Ù…Ø¹Ù…Ø±ÙŠ",
            "day": "Ø§Ù„Ø¬Ù…Ø¹Ø©",
            "time": "8:00 - 9:30 Ù…",
            "stage": "Ø§Ù„ØµÙ Ø§Ù„Ø«Ø§Ù†ÙŠ Ø¹Ø´Ø±",
            "subject": "Ø§Ù„ÙƒÙŠÙ…ÙŠØ§Ø¡",
            "content": "Ù…Ø±Ø§Ø¬Ø¹Ø© Ø¹Ø§Ù…Ø© Ø¹Ù„Ù‰ Ø§Ù„ÙˆØ­Ø¯Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰ ( Ø­Ù„ Ø£Ø³Ø¦Ù„Ø© Ù…ØªÙ†ÙˆØ¹Ø© Ùˆ Ù†Ù…Ø§Ø°Ø¬ Ø§Ù…ØªØ­Ø§Ù†Ø§Øª Ù†Ù‡Ø§Ø¦ÙŠØ© )",
            "price": 5
          },
          {
            "id": "class_6",
            "teacher": "Ù…Ø­Ù…ÙˆØ¯ Ø§Ù„ØºØ§ÙØ±ÙŠ",
            "day": "Ø§Ù„Ø¬Ù…Ø¹Ø©",
            "time": "8:00 - 9:30 Ù…",
            "stage": "Ø§Ù„ØµÙ Ø§Ù„Ø®Ø§Ù…Ø³ ",
            "subject": "Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©",
            "content": "Ù…Ø±Ø§Ø¬Ø¹Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ Ø§Ù„ØªØ±ÙƒÙŠØ² Ø¹Ù„Ù‰ Ø§Ù„ÙˆØ­Ø¯ØªÙŠÙ† Ø§Ù„Ø£ÙˆÙ„Ù‰ ÙˆØ§Ù„Ø«Ø§Ù†ÙŠØ©",
            "price": 5
          },
          {
            "id": "class_7",
            "teacher": "Ø¥Ø¨Ø±Ø§Ù‡ÙŠÙ… Ø§Ù„Ù…Ù‚Ø¨Ø§Ù„ÙŠ",
            "day": "Ø§Ù„Ø¬Ù…Ø¹Ø©",
            "time": "8:00 - 9:30 Ù…",
            "stage": "Ø§Ù„ØµÙ  Ø§Ù„ØªØ§Ø³Ø¹",
            "subject": "ÙÙŠØ²ÙŠØ§Ø¡",
            "content": "ØªØ¨Ø³ÙŠØ· Ø§Ù„Ù‚ÙˆØ§Ù†ÙŠÙ† ÙˆØ§Ù„Ù…Ø³Ø§Ø¦Ù„ Ø§Ù„Ù…Ø¹Ù‚Ø¯Ø© Ø¨Ø·Ø±ÙŠÙ‚Ø© Ø³Ù„Ø³Ù„Ø© ÙˆÙˆØ§Ø¶Ø­Ø© - Ø­Ù„ Ù†Ù…Ø§Ø°Ø¬ ÙˆØ£Ø³Ø¦Ù„Ø© Ø§Ù…ØªØ­Ø§Ù†ÙŠØ© Ù…ØªÙˆÙ‚Ø¹Ø©. - ØªØ¯Ø±ÙŠØ¨ Ø§Ù„Ø·Ù„Ø§Ø¨ Ø¹Ù„Ù‰ Ù…Ù‡Ø§Ø±Ø§Øª Ø§Ù„ØªÙÙƒÙŠØ± Ø§Ù„Ø¹Ù„Ù…ÙŠ ÙˆØ­Ù„ Ø§Ù„Ù…Ø³Ø§Ø¦Ù„ Ø¨Ø³Ø±Ø¹Ø© ÙˆØ¨Ø¯Ù‚Ø© - Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø¹Ù† Ø£Ø³Ø¦Ù„Ø© ÙˆØ§Ø³ØªÙØ³Ø§Ø±Ø§Øª Ø§Ù„Ø·Ù„Ø§Ø¨ Ù…Ø¨Ø§Ø´Ø±Ø©.",
            "price": 5
          },
          {
            "id": "class_8",
            "teacher": "Ù…Ø­Ù…Ø¯ Ø§Ù„Ù…Ø²Ø±ÙˆØ¹ÙŠ",
            "day": "Ø§Ù„Ø³Ø¨Øª",
            "time": "9:00 - 10:30 Øµ",
            "stage": "Ø§Ù„ØµÙ Ø§Ù„Ø¹Ø§Ø´Ø±",
            "subject": "Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠØ§Øª",
            "content": "ØªØ¯Ø±ÙŠØ¨Ø§Øª Ù…ØªÙ†ÙˆØ¹Ø© Ø¹Ù„Ù‰ Ø£Ù†Ù…Ø§Ø· Ø£Ø³Ø¦Ù„Ø© Ø§Ù…ØªØ­Ø§Ù† Ù†Ù‡Ø§ÙŠØ© Ø§Ù„ÙØµÙ„ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ Ø§Ù„Ø£ÙˆÙ„ Ù„Ù„ÙˆØ­Ø¯Ø§Øª Ù…Ù† 1 Ø¥Ù„Ù‰ 4 ( Ù…Ø¹ Ù…Ø±Ø§Ø¬Ø¹Ø© Ø³Ø±ÙŠØ¹Ø© Ù„Ø£Ù‡Ù… Ø§Ù„Ù…ÙØ§Ù‡ÙŠÙ… Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© )",
            "price": 5
          },
          {
            "id": "class_9",
            "teacher": "Ø¹Ù…Ø± Ø§Ù„ØºØ§ÙØ±ÙŠ",
            "day": "Ø§Ù„Ø³Ø¨Øª",
            "time": "9:00 - 10:30 Øµ",
            "stage": "Ø§Ù„ØµÙ Ø§Ù„Ø«Ø§Ù…Ù†",
            "subject": "Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠØ§Øª",
            "content": "Ù…Ø±Ø§Ø¬Ø¹Ø© Ø¹Ù„Ù‰ Ø§Ù„ÙˆØ­Ø¯Ø§Øª 1,2,3 Ù…Ù† Ø®Ù„Ø§Ù„ Ø­Ù„ Ù†Ù…Ø§Ø°Ø¬ Ø§Ù…ØªØ­Ø§Ù†Ø§Øª Ùˆ Ø£Ø³Ø¦Ù„Ø© Ù…ØªÙ†ÙˆØ¹Ø© ( Ù…Ø¹ Ø§Ù„ØªØ±ÙƒÙŠØ² Ø¹Ù„Ù‰ Ù…Ù‡Ø§Ø±Ø§Øª Ø§Ù„Ø­Ù„ Ø§Ù„Ù…Ù†Ø¸Ù…Ø© Ùˆ ÙƒØªØ§Ø¨Ø© Ø®Ø·ÙˆØ§Øª Ø§Ù„Ø­Ù„ )",
            "price": 5
          },
          {
            "id": "class_10",
             "teacher": "Ø¨Ø¯Ø± Ø§Ù„Ø¹Ø¨Ø±ÙŠ",
            "day": "Ø§Ù„Ø³Ø¨Øª",
            "time": "11:00 - 12:30 Øµ",
            "stage": "Ø§Ù„ØµÙ Ø§Ù„Ø«Ø§Ù†ÙŠ Ø¹Ø´Ø±",
            "subject": "ÙÙŠØ²ÙŠØ§Ø¡",
            "content": "Ù…Ø±Ø§Ø¬Ø¹Ø© Ø´Ø§Ù…Ù„Ø© Ù„Ù„ÙˆØ­Ø¯Ø© Ø§Ù„Ø«Ø§Ù†ÙŠØ© (Ø§Ù„Ù…Ø¬Ø§Ù„Ø§Øª Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠØ© ÙˆÙ‚Ø§Ù†ÙˆÙ† ÙƒÙˆÙ„ÙˆÙ…)",
            "price": 5
          },
          {
            "id": "class_11",
            "teacher": "Ø®Ø§Ù„Ø¯ Ø§Ù„ÙƒÙ„Ø¨Ø§Ù†ÙŠ",
            "day": "Ø§Ù„Ø³Ø¨Øª",
            "time": "6:00 - 7:30 Ù…",
            "stage": "Ø§Ù„ØµÙ Ø§Ù„Ø«Ø§Ù†ÙŠ Ø¹Ø´Ø±",
            "subject": "Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠØ§Øª Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø©",
            "content": "Ù…Ø±Ø§Ø¬Ø¹Ø© Ø´Ø§Ù…Ù„Ø© Ù„Ù„ÙˆØ­Ø¯Ø© Ø§Ù„Ø±Ø§Ø¨Ø¹Ø© ÙˆØ­Ø¯Ø© Ø§Ù„ØªÙØ§Ø¶Ù„ Ø¨Ø£Ø³Ù„ÙˆØ¨ Ø´ÙŠÙ‚ Ø³ÙŠØªÙ… Ø¹Ø±Ø¶ Ø§Ø³Ø¦Ù„Ø© Ø§Ø®ØªÙŠØ§Ø± Ù…Ù† Ù…ØªØ¹Ø¯Ø¯ ÙˆØ§Ø³Ø¦Ù„Ø© Ù…Ù‚Ø§Ù„ÙŠØ© Ø¹Ù„Ù‰ Ø§Ù„ÙˆØ­Ø¯Ø© ÙˆÙ‚ÙˆØ§Ù†ÙŠÙ†Ù‡Ø§ ÙˆÙŠÙ…ÙƒÙ† Ù„Ø§Ø­Ù‚Ø§ Ø§Ø±Ø³Ø§Ù„ Ø§Ù„Ù…Ø°ÙƒØ±Ø© Ù„Ù„Ø·Ù„Ø§Ø¨",
            "price": 5
          },
          {
            "id": "class_12",
            "teacher": "Ø¯Ø±ÙˆÙŠØ´ Ø§Ù„ØºØ§ÙØ±ÙŠ",
            "day": "Ø§Ù„Ø³Ø¨Øª",
            "time": "6:00 - 7:30 Ù…",
            "stage": "Ø§Ù„ØµÙ Ø§Ù„Ø³Ø§Ø¯Ø³",
            "subject": "Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠØ§Øª",
            "content": "Ø§Ù„ØªØ¯Ø±Ø¨ Ø¹Ù„Ù‰ ÙƒÙŠÙÙŠØ© Ø§Ù„ØªØ¹Ø§Ù…Ù„  Ù…Ø¹ Ø§Ù„Ù…ÙØ±Ø¯Ø§Øª Ø§Ù„Ø§Ù…ØªØ­Ø§Ù†ÙŠØ© Ø¨Ø·Ø±Ù‚ ÙˆØ§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ§Øª Ø­Ø¯ÙŠØ«Ø© Ùˆ Ù…Ø¨ØªÙƒØ±Ø©",
            "price": 5
          },
          {
            "id": "class_13",
            "teacher": "Ø®Ù„ÙŠÙ„ Ø§Ù„ÙƒÙ„Ø¨Ø§Ù†ÙŠ",
            "day": "Ø§Ù„Ø³Ø¨Øª",
            "time": "6:00 - 7:30 Ù…",
            "stage": "Ø§Ù„ØµÙ Ø§Ù„Ø«Ø§Ù…Ù†",
            "subject": "Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©",
            "content": "Ù…Ø±Ø§Ø¬Ø¹Ø© Ù†Ù‡Ø§Ø¦ÙŠØ© Ù„Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØŒ Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø­Ù„ Ø§Ù„Ø£Ø³Ù‡Ù„ Ù„Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±ÙŠØ©ØŒ Ø·Ø±Ù‚ Ø¨Ø³ÙŠØ·Ø© ÙˆÙ…Ø§ØªØ¹Ø© Ù„Ù„ÙˆØµÙˆÙ„ Ù„Ù„Ø¥Ø¬Ø§Ø¨Ø§Øª ØŒ ÙƒÙ† Ù…ØªÙ‚Ù†Ø§ Ù„Ù„Ø·Ø±ÙŠÙ‚Ø© Ù‚Ø¨Ù„ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø©.",
            "price": 5
          }
        ];

        // ================= Ù…ØªØºÙŠØ±Ø§Øª Ø¹Ù…Ù„ =================
        let currentStep = 1;
        let selectedClasses = [];
        let uploadedFile = null;
        let studentData = {};
        let pricingSummary = {
            count: 0,
            normalTotal: 0,
            final: 0,
            discount: 0,
            packs: {},
            offerLabel: 'Ù„Ø§ ÙŠÙˆØ¬Ø¯'
        };
        let lastRefId = '';

        // ================= ØªÙ†Ù‚Ù„ Ø¨ÙŠÙ† Ø§Ù„Ø®Ø·ÙˆØ§Øª =================
        function updateProgress() {
            const bar = document.getElementById('progressBar');
            const percent = ((currentStep - 1) / 3) * 100;
            bar.style.width = percent + '%';
            
            document.querySelectorAll('.step').forEach((step, index) => {
                const num = index + 1;
                step.classList.remove('active', 'completed');
                if (num < currentStep) step.classList.add('completed');
                else if (num === currentStep) step.classList.add('active');
            });
        }

        function showStep(step) {
            document.querySelectorAll('.form-step').forEach(s => s.classList.remove('active'));
            document.getElementById('step' + step).classList.add('active');
            currentStep = step;
            updateProgress();

            if (step === 2) {
                if (!validateStep(1)) {
                    showStep(1);
                    return;
                }
            }

            if (step === 3) {
                if (!validateStep(2)) {
                    showStep(2);
                    return;
                }
                document.getElementById('paymentAmountLabel').textContent = pricingSummary.final + ' Ø±ÙŠØ§Ù„ Ø¹ÙÙ…Ø§Ù†ÙŠ';
            }

            if (step === 4) {
                if (!validateStep(3)) {
                    showStep(3);
                    return;
                }
                updateSummaryBeforeSubmit();
            }
        }

        function nextStep() {
            if (!validateStep(currentStep)) return;
            if (currentStep < 4) {
                if (currentStep === 1) saveStep1();
                showStep(currentStep + 1);
            }
        }

        function prevStep() {
            if (currentStep > 1) {
                showStep(currentStep - 1);
            }
        }

        // ================= Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø§Ù„Ù…Ø¯Ø®Ù„Ø§Øª =================
        function validateStep(step) {
            let valid = true;
            document.querySelectorAll('.error-message').forEach(el => el.style.display = 'none');

            if (step === 1) {
                const name = document.getElementById('studentName').value.trim();
                const grade = document.getElementById('grade').value;
                const phone = document.getElementById('phone').value.trim();

                if (!name) {
                    showError('studentNameError', 'Ù‡Ø°Ø§ Ø§Ù„Ø­Ù‚Ù„ Ù…Ø·Ù„ÙˆØ¨');
                    valid = false;
                }
                if (!grade) {
                    showError('gradeError', 'ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„ØµÙ');
                    valid = false;
                }
                if (!phone || !/^\d{8,9}$/.test(phone)) {
                    showError('phoneError', 'Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ ØºÙŠØ± ØµØ­ÙŠØ­');
                    valid = false;
                }
            }

            if (step === 2) {
                if (selectedClasses.length === 0) {
                    alert('ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ø­ØµØ© ÙˆØ§Ø­Ø¯Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„');
                    valid = false;
                }
            }

            if (step === 3) {
                if (!uploadedFile) {
                    showError('receiptError', 'Ø±ÙØ¹ Ø¥ÙŠØµØ§Ù„ Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ù…Ø·Ù„ÙˆØ¨');
                    valid = false;
                }
            }

            if (step === 4) {
                const agree = document.getElementById('agreeTerms').checked;
                if (!agree) {
                    showError('termsError', 'ÙŠØ¬Ø¨ Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø´Ø±ÙˆØ· ÙˆØ§Ù„Ø£Ø­ÙƒØ§Ù… Ù‚Ø¨Ù„ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„');
                    valid = false;
                }
            }

            return valid;
        }

        function showError(id, msg) {
            const el = document.getElementById(id);
            if (el) {
                el.textContent = msg;
                el.style.display = 'block';
            }
        }

        // ================= Ø­ÙØ¸ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø·Ø§Ù„Ø¨ =================
        function saveStep1() {
            studentData = {
                name: document.getElementById('studentName').value.trim(),
                grade: document.getElementById('grade').value,
                phone: document.getElementById('phone').value.trim(),
                email: document.getElementById('email').value.trim(),
                notes: document.getElementById('notes').value.trim()
            };
        }

        // ================= Ø¹Ø±Ø¶ Ø§Ù„Ø­ØµØµ =================
        function renderClasses() {
            const container = document.getElementById('classesContainer');
            container.innerHTML = '';

            const grouped = {};
            CLASSES.forEach(cls => {
                if (!grouped[cls.day]) grouped[cls.day] = [];
                grouped[cls.day].push(cls);
            });

            const dayOrder = ['Ø§Ù„Ø¬Ù…Ø¹Ø©', 'Ø§Ù„Ø³Ø¨Øª'];
            dayOrder.forEach(day => {
                if (!grouped[day]) return;

                const dayTitle = document.createElement('h4');
                dayTitle.className = 'day-title';
                dayTitle.innerHTML = `<i class="far fa-calendar-alt"></i> ${day}`;
                container.appendChild(dayTitle);

                const grid = document.createElement('div');
                grid.className = 'classes-grid';

                grouped[day].forEach(cls => {
                    const imgUrl = TEACHER_IMAGES[cls.teacher] || DEFAULT_IMAGE;
                    const item = document.createElement('div');
                    item.className = 'class-item';
                    item.dataset.id = cls.id;
                    item.onclick = () => toggleClassSelection(cls.id);

                    item.innerHTML = `
                        <div class="class-media">
                            <img src="${imgUrl}" alt="${cls.teacher}">
                            <div class="class-media-badge">
                                <i class="fas fa-clock"></i> ${cls.time}
                            </div>
                        </div>
                        <div class="class-body">
                            <div class="class-header">
                                <div>
                                    <div class="class-title">${cls.subject}</div>
                                    <div class="class-teacher">
                                        <i class="fas fa-chalkboard-teacher"></i>
                                        ${cls.teacher}
                                    </div>
                                </div>
                                <div class="class-price">5 Ø±ÙŠØ§Ù„</div>
                            </div>
                            <div class="class-meta">
                                <span class="class-chip">
                                    <i class="fas fa-layer-group"></i>
                                    ${cls.stage}
                                </span>
                                <span class="class-chip">
                                    <i class="fas fa-location-dot"></i>
                                    Ø­Ø¶ÙˆØ±ÙŠ
                                </span>
                            </div>
                            <div class="class-content">
                                ${cls.content}
                            </div>
                        </div>
                    `;
                    grid.appendChild(item);
                });

                container.appendChild(grid);
            });
        }

        function toggleClassSelection(id) {
            const index = selectedClasses.findIndex(c => c.id === id);
            const cls = CLASSES.find(c => c.id === id);
            if (!cls) return;

            if (index === -1) {
                selectedClasses.push(cls);
            } else {
                selectedClasses.splice(index, 1);
            }

            document.querySelectorAll('.class-item').forEach(el => {
                if (el.dataset.id === id) {
                    el.classList.toggle('selected', index === -1);
                }
            });

            updatePricing();
        }

        // ================= Ø§Ù„ØªØ³Ø¹ÙŠØ± Ø§Ù„Ø°ÙƒÙŠ =================
        function calculateBestPrice(count) {
            if (count === 0) {
                return {
                    cost: 0,
                    packs: {},
                    offerLabel: 'Ù„Ø§ ÙŠÙˆØ¬Ø¯'
                };
            }

            const dp = new Array(count + 1).fill(null);
            dp[0] = { cost: 0, packs: {} };

            for (let i = 1; i <= count; i++) {
                PACKS.forEach(pack => {
                    if (pack.size <= i && dp[i - pack.size]) {
                        const prev = dp[i - pack.size];
                        const newCost = prev.cost + pack.price;
                        if (!dp[i] || newCost < dp[i].cost) {
                            dp[i] = {
                                cost: newCost,
                                packs: { ...prev.packs }
                            };
                            dp[i].packs[pack.size] = (dp[i].packs[pack.size] || 0) + 1;
                        }
                    }
                });
            }

            const result = dp[count];
            if (!result) {
                return {
                    cost: count * 5,
                    packs: { 1: count },
                    offerLabel: 'Ø­ØµØ© Ù…ÙØ±Ø¯Ø© (Ø¨Ø¯ÙˆÙ† Ø¹Ø±Ø¶)'
                };
            }

            const normal = count * 5;
            const discount = normal - result.cost;

            let offerLabel = 'Ù„Ø§ ÙŠÙˆØ¬Ø¯';
            const parts = [];
            Object.keys(result.packs).sort((a,b) => b - a).forEach(size => {
                const n = result.packs[size];
                const pack = PACKS.find(p => p.size == size);
                if (!pack) return;
                if (size == 1) {
                    parts.push(`${n} Ø­ØµØ© Ù…ÙØ±Ø¯Ø©`);
                } else {
                    parts.push(`${n} Ã— ${pack.label}`);
                }
            });

            if (discount > 0) {
                offerLabel = parts.join(' + ');
            } else {
                offerLabel = 'Ø¨Ø¯ÙˆÙ† Ø®ØµÙ… (Ø­ØµØ© Ù…ÙØ±Ø¯Ø©)';
            }

            return {
                cost: result.cost,
                packs: result.packs,
                offerLabel
            };
        }

        function updatePricing() {
            const count = selectedClasses.length;
            const normalTotal = count * 5;
            const best = calculateBestPrice(count);
            const discount = normalTotal - best.cost;

            pricingSummary = {
                count,
                normalTotal,
                final: best.cost,
                discount: discount > 0 ? discount : 0,
                packs: best.packs,
                offerLabel: best.offerLabel
            };

            // ØªØ­Ø¯ÙŠØ« Ù…Ù„Ø®Øµ Ø§Ù„Ø®Ø·ÙˆØ© 2
            document.getElementById('selectedCount').textContent = count;
            document.getElementById('normalTotal').textContent = normalTotal + ' Ø±ÙŠØ§Ù„';
            document.getElementById('discountValue').textContent = pricingSummary.discount + ' Ø±ÙŠØ§Ù„';
            document.getElementById('finalAmount').textContent = pricingSummary.final + ' Ø±ÙŠØ§Ù„';
            document.getElementById('offerLabel').textContent = pricingSummary.offerLabel;

            const packsDiv = document.getElementById('packsBreakdown');
            if (count === 0) {
                packsDiv.style.display = 'none';
                packsDiv.textContent = '';
            } else {
                const parts = [];
                Object.keys(pricingSummary.packs).sort((a,b) => b - a).forEach(size => {
                    const n = pricingSummary.packs[size];
                    const pack = PACKS.find(p => p.size == size);
                    if (!pack) return;
                    if (size == 1) {
                        parts.push(`${n} Ø­ØµØ© Ù…ÙØ±Ø¯Ø©`);
                    } else {
                        parts.push(`${n} Ã— ${pack.label}`);
                    }
                });
                packsDiv.textContent = 'ØªÙØµÙŠÙ„ Ø§Ù„Ø­Ø³Ø¨Ø©: ' + parts.join(' + ');
                packsDiv.style.display = 'block';
            }
        }

        // ================= Ø±ÙØ¹ Ù…Ù„Ù Ø§Ù„Ø¥ÙŠØµØ§Ù„ =================
        function handleFileUpload(files) {
            if (!files.length) return;
            const file = files[0];

            if (file.size > 5 * 1024 * 1024) {
                alert('Ø­Ø¬Ù… Ø§Ù„Ù…Ù„Ù Ø£ÙƒØ¨Ø± Ù…Ù† 5MB');
                return;
            }

            if (!file.type.match(/image\/(jpeg|png|jpg)|application\/pdf/)) {
                alert('Ù†ÙˆØ¹ Ø§Ù„Ù…Ù„Ù ØºÙŠØ± Ù…Ø¯Ø¹ÙˆÙ…ØŒ ÙŠÙØ³Ù…Ø­ Ø¨Ø§Ù„ØµÙˆØ± Ø£Ùˆ PDF ÙÙ‚Ø·');
                return;
            }

            uploadedFile = file;

            const preview = document.getElementById('filePreview');
            const isImage = file.type.includes('image');
            preview.innerHTML = `
                <div class="file-preview">
                    <div class="file-info">
                        <div class="file-icon">
                            <i class="fas fa-${isImage ? 'file-image' : 'file-pdf'}"></i>
                        </div>
                        <div>
                            <div class="file-name">${file.name}</div>
                            <div class="file-size">${(file.size / 1024).toFixed(1)} ÙƒÙŠÙ„ÙˆØ¨Ø§ÙŠØª</div>
                        </div>
                    </div>
                    <button class="file-remove" onclick="removeFile()">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            `;
            preview.style.display = 'block';
        }

        function removeFile() {
            uploadedFile = null;
            document.getElementById('receiptFile').value = '';
            document.getElementById('filePreview').style.display = 'none';
        }

        // ================= Ù…Ù„Ø®Øµ Ù‚Ø¨Ù„ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ =================
        function updateSummaryBeforeSubmit() {
            document.getElementById('summaryName').textContent = studentData.name || '-';
            document.getElementById('summaryGrade').textContent = studentData.grade || '-';
            document.getElementById('summaryPhone').textContent = studentData.phone || '-';
            document.getElementById('summaryEmail').textContent = studentData.email || 'Ù„Ù… ÙŠØªÙ… Ø¥Ø¯Ø®Ø§Ù„Ù‡';

            if (selectedClasses.length > 0) {
                const names = selectedClasses.map(c => `${c.subject} - ${c.teacher} (${c.day} ${c.time})`);
                document.getElementById('summaryClasses').textContent = names.join(' | ');
                document.getElementById('summaryCount').textContent = selectedClasses.length;
            } else {
                document.getElementById('summaryClasses').textContent = '-';
                document.getElementById('summaryCount').textContent = '0';
            }

            document.getElementById('summaryTotal').textContent = pricingSummary.normalTotal + ' Ø±ÙŠØ§Ù„';
            document.getElementById('summaryDiscountAmount').textContent = pricingSummary.discount + ' Ø±ÙŠØ§Ù„';
            document.getElementById('summaryFinal').textContent = pricingSummary.final + ' Ø±ÙŠØ§Ù„';
            document.getElementById('summaryOfferLabel').textContent = pricingSummary.offerLabel || 'Ù„Ø§ ÙŠÙˆØ¬Ø¯';
        }

        // ================= API Ù…Ø¹ Google Apps Script =================
        async function testConnection() {
            try {
                showMessage('info', 'Ø¬Ø§Ø±ÙŠ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø§ØªØµØ§Ù„...');
                const url = GOOGLE_SCRIPT_URL + '?action=test&t=' + Date.now();
                const response = await fetch(url);
                const data = await response.json();

                if (data.success) {
                    showMessage('success', 'âœ… Ø§ØªØµØ§Ù„ Ù†Ø§Ø¬Ø­ Ù…Ø¹ Google Sheets');
                } else {
                    showMessage('error', 'âŒ ÙØ´Ù„ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„: ' + (data.message || ''));
                }
            } catch (error) {
                console.error('Connection error:', error);
                showMessage('error', 'âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù€ Google Sheets');
            }
        }

        async function submitRegistration() {
            if (!validateStep(4)) return;

            const count = pricingSummary.count;
            const total = pricingSummary.normalTotal;
            const discount = pricingSummary.discount;
            const final = pricingSummary.final;
            const offer = pricingSummary.offerLabel;

            const classesStr = selectedClasses
                .map(c => `${c.subject} - ${c.teacher} (${c.day} ${c.time})`)
                .join('ØŒ ');

            const data = {
                action: 'submit',
                name: studentData.name,
                grade: studentData.grade,
                phone: studentData.phone,
                email: studentData.email,
                classes: classesStr,
                count: count.toString(),
                total: total.toString(),
                discount: discount.toString(),
                final: final.toString(),
                offer: offer,
                file: uploadedFile ? uploadedFile.name : '',
                notes: studentData.notes || ''
            };

            document.getElementById('loader').style.display = 'block';
            document.getElementById('submitBtn').disabled = true;

            try {
                const params = new URLSearchParams();
                Object.keys(data).forEach(key => params.append(key, data[key]));

                const response = await fetch(GOOGLE_SCRIPT_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
                    body: params.toString()
                });

                const result = await response.json();

                if (result.success) {
                    lastRefId = result.ref || '';
                    showSuccess(result.ref);
                } else {
                    alert('ÙØ´Ù„ ÙÙŠ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„: ' + (result.message || ''));
                    document.getElementById('submitBtn').disabled = false;
                }
            } catch (error) {
                console.error('Submit error:', error);
                alert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„: ' + error.message);
                document.getElementById('submitBtn').disabled = false;
            } finally {
                document.getElementById('loader').style.display = 'none';
            }
        }

        function showSuccess(refId) {
            document.getElementById('summaryBeforeSubmit').style.display = 'none';

            const resultDiv = document.getElementById('registrationResult');
            const shareText = buildWhatsAppText(refId);

            resultDiv.innerHTML = `
                <div class="success-message">
                    <div class="success-icon">
                        <i class="fas fa-check-circle"></i>
                    </div>
                    <h3>ğŸ‰ ØªÙ… Ø§Ù„ØªØ³Ø¬ÙŠÙ„ Ø¨Ù†Ø¬Ø§Ø­!</h3>
                    <div class="reference-id">
                        <span>Ø±Ù‚Ù… Ø§Ù„Ù…Ø±Ø¬Ø¹:</span>
                        <strong>${refId}</strong>
                    </div>
                    <p style="color: var(--text-light); margin: 15px 0;">
                        âœ… ØªÙ… Ø­ÙØ¸ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ³Ø¬ÙŠÙ„ ÙÙŠ Ø§Ù„Ù†Ø¸Ø§Ù….<br>
                        ğŸ“± Ø³ÙŠØªÙ… Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹ÙƒÙ… Ø¹Ø¨Ø± Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨ Ù„ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø­Ø¶ÙˆØ± ÙˆØªØ±ØªÙŠØ¨ Ø§Ù„ØªÙØ§ØµÙŠÙ„.
                    </p>
                    <div class="action-buttons">
                        <button class="btn btn-primary" onclick="copyWhatsAppSummary()">
                            <i class="fas fa-copy"></i> Ù†Ø³Ø® Ù…Ù„Ø®Øµ Ø§Ù„ØªØ³Ø¬ÙŠÙ„
                        </button>
                        <button class="btn btn-outline-whatsapp" onclick="openWhatsAppShare()">
                            <i class="fab fa-whatsapp"></i> Ù…Ø´Ø§Ø±ÙƒØ© Ø¹Ø¨Ø± ÙˆØ§ØªØ³Ø§Ø¨
                        </button>
                        <button onclick="resetForm()" class="btn btn-success">
                            <i class="fas fa-plus"></i> ØªØ³Ø¬ÙŠÙ„ Ø·Ø§Ù„Ø¨ Ø¬Ø¯ÙŠØ¯
                        </button>
                    </div>
                </div>
            `;
            resultDiv.style.display = 'block';
        }

        // ================= Ù…Ù„Ø®Øµ ÙˆØ§ØªØ³Ø§Ø¨ =================
        function buildWhatsAppText(refId) {
            const lines = [];
            lines.push('ğŸ“ Ø£ÙƒØ§Ø¯ÙŠÙ…ÙŠØ© Ù…Ù„Ù‡Ù… Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ©');
            lines.push('Ù†Ù…ÙˆØ°Ø¬ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø­ØµØµ Ø§Ù„Ø­Ø¶ÙˆØ±ÙŠØ©');
            lines.push('');
            lines.push('Ø±Ù‚Ù… Ø§Ù„Ù…Ø±Ø¬Ø¹: ' + (refId || lastRefId || 'ØºÙŠØ± Ù…ØªÙˆÙØ±'));
            lines.push('Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨: ' + (studentData.name || '-'));
            lines.push('Ø§Ù„ØµÙ: ' + (studentData.grade || '-'));
            lines.push('Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ: ' + (studentData.phone || '-'));
            lines.push('');
            lines.push('Ø§Ù„Ø­ØµØµ Ø§Ù„Ù…Ø³Ø¬Ù„Ø©:');
            if (selectedClasses.length === 0) {
                lines.push('- Ù„Ù… ØªÙØ³Ø¬Ù„ Ø­ØµØµ');
            } else {
                selectedClasses.forEach(c => {
                    lines.push(`- ${c.subject} - ${c.teacher} (${c.day} ${c.time})`);
                });
            }
            lines.push('');
            lines.push('Ø¹Ø¯Ø¯ Ø§Ù„Ø­ØµØµ: ' + (pricingSummary.count || 0));
            lines.push('Ø§Ù„Ø³Ø¹Ø± Ø¨Ø¯ÙˆÙ† Ø¹Ø±ÙˆØ¶: ' + (pricingSummary.normalTotal || 0) + ' Ø±ÙŠØ§Ù„');
            lines.push('Ù‚ÙŠÙ…Ø© Ø§Ù„Ø®ØµÙ…: ' + (pricingSummary.discount || 0) + ' Ø±ÙŠØ§Ù„');
            lines.push('Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ: ' + (pricingSummary.final || 0) + ' Ø±ÙŠØ§Ù„');
            lines.push('Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø·Ø¨Ù‚: ' + (pricingSummary.offerLabel || 'Ù„Ø§ ÙŠÙˆØ¬Ø¯'));
            lines.push('');
            lines.push('Ø´ÙƒØ±Ø§Ù‹ Ù„Ø§Ø®ØªÙŠØ§Ø±ÙƒÙ… Ø£ÙƒØ§Ø¯ÙŠÙ…ÙŠØ© Ù…Ù„Ù‡Ù… Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ© ğŸŒŸ');

            return lines.join('\n');
        }

        async function copyWhatsAppSummary() {
            const text = buildWhatsAppText(lastRefId);
            try {
                await navigator.clipboard.writeText(text);
                showMessage('success', 'âœ… ØªÙ… Ù†Ø³Ø® Ù…Ù„Ø®Øµ Ø§Ù„ØªØ³Ø¬ÙŠÙ„ØŒ ÙŠÙ…ÙƒÙ†Ùƒ Ù„ØµÙ‚Ù‡ ÙÙŠ Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨ Ù…Ø¨Ø§Ø´Ø±Ø©.');
            } catch (error) {
                console.error('Clipboard error:', error);
                alert('ØªØ¹Ø°Ø± Ø§Ù„Ù†Ø³Ø® Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠØŒ ÙŠÙ…ÙƒÙ†Ùƒ Ù†Ø³Ø® Ø§Ù„Ù†Øµ Ø§Ù„ØªØ§Ù„ÙŠ ÙŠØ¯ÙˆÙŠØ§Ù‹:\n\n' + text);
            }
        }

        function openWhatsAppShare() {
            const text = buildWhatsAppText(lastRefId);
            const url = 'https://wa.me/?text=' + encodeURIComponent(text);
            window.open(url, '_blank');
        }

        // ================= Ø±Ø³Ø§Ø¦Ù„ Ù…Ø³Ø§Ø¹Ø¯Ø© =================
        function showMessage(type, text) {
            const types = {
                'success': {el: 'successMessage', txt: 'successText'},
                'error':   {el: 'errorMessage',   txt: 'errorText'},
                'info':    {el: 'infoMessage',    txt: 'infoText'}
            };
            Object.values(types).forEach(t => {
                document.getElementById(t.el).style.display = 'none';
            });
            const msg = types[type];
            if (!msg) return;
            document.getElementById(msg.el).style.display = 'block';
            document.getElementById(msg.txt).textContent = text;
            setTimeout(() => {
                document.getElementById(msg.el).style.display = 'none';
            }, 5000);
        }

        function resetForm() {
            document.getElementById('basicInfoForm').reset();
            selectedClasses = [];
            uploadedFile = null;
            studentData = {};
            pricingSummary = {
                count: 0,
                normalTotal: 0,
                final: 0,
                discount: 0,
                packs: {},
                offerLabel: 'Ù„Ø§ ÙŠÙˆØ¬Ø¯'
            };
            lastRefId = '';

            document.querySelectorAll('.class-item').forEach(el => el.classList.remove('selected'));
            document.getElementById('filePreview').style.display = 'none';
            document.getElementById('agreeTerms').checked = false;

            updatePricing();

            document.getElementById('summaryBeforeSubmit').style.display = 'block';
            document.getElementById('registrationResult').style.display = 'none';

            showStep(1);
            document.getElementById('submitBtn').disabled = false;
            showMessage('success', 'âœ… ØªÙ… Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ Ø¨Ù†Ø¬Ø§Ø­.');
        }

        function testGoogleSheetsConnection() {
            testConnection();
        }

        // ================= ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØµÙØ­Ø© =================
        document.addEventListener('DOMContentLoaded', () => {
            renderClasses();
            updatePricing();
            updateProgress();

            // Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø³Ø­Ø¨ ÙˆØ§Ù„Ø¥ÙÙ„Ø§Øª Ù„Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø±ÙØ¹
            const uploadArea = document.getElementById('uploadArea');
            if (uploadArea) {
                uploadArea.addEventListener('dragover', e => {
                    e.preventDefault();
                    uploadArea.classList.add('dragover');
                });
                uploadArea.addEventListener('dragleave', e => {
                    e.preventDefault();
                    uploadArea.classList.remove('dragover');
                });
                uploadArea.addEventListener('drop', e => {
                    e.preventDefault();
                    uploadArea.classList.remove('dragover');
                    if (e.dataTransfer.files.length) {
                        handleFileUpload(e.dataTransfer.files);
                    }
                });
            }

            // Ø§Ø®ØªØ¨Ø§Ø± Ø§ØªØµØ§Ù„ ØªÙ„Ù‚Ø§Ø¦ÙŠ Ø¨Ø³ÙŠØ· Ø¨Ø¹Ø¯ Ø«Ø§Ù†ÙŠØªÙŠÙ† (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)
            setTimeout(() => {
                testConnection();
            }, 2000);
        });
    </script>
</body>
</html>





